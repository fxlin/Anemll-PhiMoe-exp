graph(%self.1 : __torch__.PrefillWrapper,
      %hidden_states.1 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=0, device=cpu),
      %position_ids : Long(64, strides=[1], requires_grad=0, device=cpu),
      %causal_mask : Half(1, 1, 64, 512, strides=[32768, 32768, 512, 1], requires_grad=0, device=cpu),
      %current_pos : Long(1, strides=[1], requires_grad=0, device=cpu)):
  %model.1 : __torch__.anemll.models.phimoe_model.PhimoeForCausalLM = prim::GetAttr[name="model"](%self.1)
  %model : __torch__.anemll.models.phimoe_model.PhimoeModel = prim::GetAttr[name="model"](%model.1)
  %7 : int = aten::Int(%current_pos), scope: __module.model.model
  %8 : int = aten::Int(%current_pos), scope: __module.model.model
  %10 : int = prim::Constant[value=16](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:604:0
  %11 : float = prim::Constant[value=0.02](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:412:0
  %12 : float = prim::Constant[value=-inf](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:415:0
  %13 : Device = prim::Constant[value="cpu"](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:615:0
  %14 : int = prim::Constant[value=6](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %15 : int = prim::Constant[value=7](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %16 : int = prim::Constant[value=9](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %17 : int = prim::Constant[value=10](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %18 : int = prim::Constant[value=11](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %19 : int = prim::Constant[value=12](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %20 : int = prim::Constant[value=13](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %21 : int = prim::Constant[value=14](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %22 : int = prim::Constant[value=15](), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %23 : str = prim::Constant[value="bhqk,bhkd->bhqd"](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/functional.py:422:0
  %24 : Double(requires_grad=0, device=cpu) = prim::Constant[value={11.3137}](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1034:0
  %25 : str = prim::Constant[value="bhqd,bhkd->bhqk"](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/functional.py:422:0
  %26 : int = prim::Constant[value=-2](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %27 : int = prim::Constant[value=4](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1069:0
  %28 : int = prim::Constant[value=512](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1007:0
  %29 : int = prim::Constant[value=-1](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:938:0
  %30 : Long(requires_grad=0, device=cpu) = prim::Constant[value={2}](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/_tensor.py:1137:0
  %31 : int = prim::Constant[value=8](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:775:0
  %32 : int = prim::Constant[value=3](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:774:0
  %33 : int = prim::Constant[value=32](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:774:0
  %34 : int = prim::Constant[value=2](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:766:0
  %35 : int = prim::Constant[value=4096](), scope: __module.model.model/__module.model.model.layers.0.input_layernorm # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2910:0
  %36 : float = prim::Constant[value=1.0000000000000001e-05](), scope: __module.model.model/__module.model.model.layers.0.input_layernorm # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2910:0
  %37 : bool = prim::Constant[value=1](), scope: __module.model.model/__module.model.model.layers.0.input_layernorm # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2910:0
  %38 : bool = prim::Constant[value=0](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1229:0
  %39 : int = prim::Constant[value=5](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1229:0
  %40 : Float(1, 131072, 128, strides=[16777216, 128, 1], requires_grad=0, device=cpu) = prim::Constant[value=<Tensor>](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1219:0
  %41 : int = prim::Constant[value=128](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %42 : NoneType = prim::Constant(), scope: __module.model.model
  %43 : int = prim::Constant[value=1](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %44 : int = prim::Constant[value=9223372036854775807](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %45 : Float(1, 131072, 128, strides=[16777216, 128, 1], requires_grad=0, device=cpu) = prim::Constant[value=<Tensor>](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %46 : int = prim::Constant[value=0](), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1217:0
  %layers : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers)
  %block_sparse_moe : __torch__.anemll.models.phimoe_model.PhimoeSparseMoeBlock = prim::GetAttr[name="block_sparse_moe"](%_0)
  %layers.11 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.11 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.11)
  %post_attention_layernorm : __torch__.torch.nn.modules.normalization.___torch_mangle_66.LayerNorm = prim::GetAttr[name="post_attention_layernorm"](%_0.11)
  %layers.9 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.9 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.9)
  %self_attn : __torch__.anemll.models.phimoe_model.PhimoeAttention = prim::GetAttr[name="self_attn"](%_0.9)
  %o_proj : __torch__.torch.nn.modules.linear.Linear = prim::GetAttr[name="o_proj"](%self_attn)
  %kv_cache_0 : Tensor = prim::GetAttr[name="kv_cache_0"](%model)
  %layers.7 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.7 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.7)
  %self_attn.5 : __torch__.anemll.models.phimoe_model.PhimoeAttention = prim::GetAttr[name="self_attn"](%_0.7)
  %v_proj : __torch__.torch.nn.modules.conv.___torch_mangle_1.Conv2d = prim::GetAttr[name="v_proj"](%self_attn.5)
  %layers.5 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.5 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.5)
  %self_attn.3 : __torch__.anemll.models.phimoe_model.PhimoeAttention = prim::GetAttr[name="self_attn"](%_0.5)
  %k_proj : __torch__.torch.nn.modules.conv.___torch_mangle_0.Conv2d = prim::GetAttr[name="k_proj"](%self_attn.3)
  %layers.3 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.3 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.3)
  %self_attn.1 : __torch__.anemll.models.phimoe_model.PhimoeAttention = prim::GetAttr[name="self_attn"](%_0.3)
  %q_proj : __torch__.torch.nn.modules.conv.Conv2d = prim::GetAttr[name="q_proj"](%self_attn.1)
  %layers.1 : __torch__.torch.nn.modules.container.___torch_mangle_143.ModuleList = prim::GetAttr[name="layers"](%model)
  %_0.1 : __torch__.anemll.models.phimoe_model.PhimoeDecoderLayer = prim::GetAttr[name="0"](%layers.1)
  %input_layernorm : __torch__.torch.nn.modules.normalization.LayerNorm = prim::GetAttr[name="input_layernorm"](%_0.1)
  %73 : int = aten::size(%position_ids, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1217:0
  %74 : Float(1, 131072, 128, strides=[16777216, 128, 1], requires_grad=0, device=cpu) = aten::slice(%45, %46, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %75 : Tensor?[] = prim::ListConstruct(%42, %position_ids), scope: __module.model.model
  %76 : Float(1, 64, 128, strides=[8192, 128, 1], requires_grad=0, device=cpu) = aten::index(%74, %75), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %77 : int[] = prim::ListConstruct(%43, %73, %43, %41), scope: __module.model.model
  %cos.1 : Float(1, 64, 1, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::view(%76, %77), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1218:0
  %79 : Float(1, 131072, 128, strides=[16777216, 128, 1], requires_grad=0, device=cpu) = aten::slice(%40, %46, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1219:0
  %80 : Tensor?[] = prim::ListConstruct(%42, %position_ids), scope: __module.model.model
  %81 : Float(1, 64, 128, strides=[8192, 128, 1], requires_grad=0, device=cpu) = aten::index(%79, %80), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1219:0
  %82 : int[] = prim::ListConstruct(%43, %73, %43, %41), scope: __module.model.model
  %sin.1 : Float(1, 64, 1, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::view(%81, %82), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1219:0
  %cos.3 : Half(1, 64, 1, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::to(%cos.1, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1229:0
  %sin.3 : Half(1, 64, 1, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::to(%sin.1, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1229:0
  %bias.11 : Tensor = prim::GetAttr[name="bias"](%input_layernorm)
  %weight.109 : Tensor = prim::GetAttr[name="weight"](%input_layernorm)
  %88 : int[] = prim::ListConstruct(%35), scope: __module.model.model/__module.model.model.layers.0.input_layernorm
  %hidden_states.3 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::layer_norm(%hidden_states.1, %88, %weight.109, %bias.11, %36, %37), scope: __module.model.model/__module.model.model.layers.0.input_layernorm # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2910:0
  %90 : int = aten::size(%hidden_states.3, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:757:0
  %91 : int[] = prim::ListConstruct(%46, %34, %43), scope: __module.model.model
  %92 : Half(1, 4096, 64, strides=[262144, 1, 4096], requires_grad=1, device=cpu) = aten::permute(%hidden_states.3, %91), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:766:0
  %93 : Half(1, 4096, 1, 64, strides=[262144, 1, 262144, 4096], requires_grad=1, device=cpu) = aten::unsqueeze(%92, %34), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:766:0
  %input.1 : Half(1, 4096, 1, 64, strides=[262144, 1, 262144, 4096], requires_grad=1, device=cpu) = aten::to(%93, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:766:0
  %bias.13 : Tensor = prim::GetAttr[name="bias"](%q_proj)
  %weight.111 : Tensor = prim::GetAttr[name="weight"](%q_proj)
  %97 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.q_proj
  %98 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.q_proj
  %99 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.q_proj
  %100 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.q_proj
  %query_states.1 : Half(1, 4096, 1, 64, strides=[262144, 1, 262144, 4096], requires_grad=0, device=cpu) = aten::_convolution(%input.1, %weight.111, %bias.13, %97, %98, %99, %38, %100, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.self_attn.q_proj # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %bias.15 : Tensor = prim::GetAttr[name="bias"](%k_proj)
  %weight.113 : Tensor = prim::GetAttr[name="weight"](%k_proj)
  %104 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.k_proj
  %105 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.k_proj
  %106 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.k_proj
  %107 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.k_proj
  %key_states.1 : Half(1, 1024, 1, 64, strides=[65536, 1, 65536, 1024], requires_grad=0, device=cpu) = aten::_convolution(%input.1, %weight.113, %bias.15, %104, %105, %106, %38, %107, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.self_attn.k_proj # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %bias.17 : Tensor = prim::GetAttr[name="bias"](%v_proj)
  %weight.115 : Tensor = prim::GetAttr[name="weight"](%v_proj)
  %111 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.v_proj
  %112 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.v_proj
  %113 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.self_attn.v_proj
  %114 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.self_attn.v_proj
  %value_states.1 : Half(1, 1024, 1, 64, strides=[65536, 1, 65536, 1024], requires_grad=0, device=cpu) = aten::_convolution(%input.1, %weight.115, %bias.17, %111, %112, %113, %38, %114, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.self_attn.v_proj # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %116 : int[] = prim::ListConstruct(%43, %33, %41, %90), scope: __module.model.model
  %117 : Half(1, 32, 128, 64, strides=[4096, 128, 1, 4096], requires_grad=1, device=cpu) = aten::view(%query_states.1, %116), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:774:0
  %118 : int[] = prim::ListConstruct(%46, %43, %32, %34), scope: __module.model.model
  %x.1 : Half(1, 32, 64, 128, strides=[4096, 128, 4096, 1], requires_grad=1, device=cpu) = aten::permute(%117, %118), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:774:0
  %120 : int[] = prim::ListConstruct(%43, %31, %41, %90), scope: __module.model.model
  %121 : Half(1, 8, 128, 64, strides=[1024, 128, 1, 1024], requires_grad=1, device=cpu) = aten::view(%key_states.1, %120), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:775:0
  %122 : int[] = prim::ListConstruct(%46, %43, %32, %34), scope: __module.model.model
  %x.5 : Half(1, 8, 64, 128, strides=[1024, 128, 1024, 1], requires_grad=1, device=cpu) = aten::permute(%121, %122), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:775:0
  %124 : int[] = prim::ListConstruct(%43, %31, %41, %90), scope: __module.model.model
  %125 : Half(1, 8, 128, 64, strides=[1024, 128, 1, 1024], requires_grad=1, device=cpu) = aten::view(%value_states.1, %124), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:776:0
  %126 : int[] = prim::ListConstruct(%46, %43, %32, %34), scope: __module.model.model
  %value_states.3 : Half(1, 8, 64, 128, strides=[1024, 128, 1024, 1], requires_grad=1, device=cpu) = aten::permute(%125, %126), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:776:0
  %128 : int[] = prim::ListConstruct(%46, %34, %43, %32), scope: __module.model.model
  %cos.5 : Half(1, 1, 64, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::permute(%cos.3, %128), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:781:0
  %130 : int[] = prim::ListConstruct(%46, %34, %43, %32), scope: __module.model.model
  %sin.5 : Half(1, 1, 64, 128, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::permute(%sin.3, %130), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:782:0
  %x.3 : Half(1, 32, 64, 128, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::contiguous(%x.1, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:919:0
  %133 : int = aten::size(%x.3, %32), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:920:0
  %134 : Long(device=cpu) = prim::NumToTensor(%133), scope: __module.model.model
  %half_dim.1 : Long(requires_grad=0, device=cpu) = aten::floor_divide(%134, %30), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/_tensor.py:1137:0
  %136 : int = aten::Int(%half_dim.1), scope: __module.model.model
  %137 : int = aten::Int(%half_dim.1), scope: __module.model.model
  %138 : int = aten::Int(%half_dim.1), scope: __module.model.model
  %139 : int = aten::Int(%half_dim.1), scope: __module.model.model
  %x1.1 : Half(1, 32, 64, 64, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::slice(%x.3, %32, %46, %139, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:922:0
  %x2.1 : Half(1, 32, 64, 64, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::slice(%x.3, %32, %138, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:923:0
  %cos.7 : Half(1, 1, 64, 64, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::slice(%cos.5, %32, %46, %137, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:931:0
  %sin.7 : Half(1, 1, 64, 64, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::slice(%sin.5, %32, %46, %136, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:932:0
  %144 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x1.1, %cos.7), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %145 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x2.1, %sin.7), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %146 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::sub(%144, %145, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %147 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x2.1, %cos.7), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %148 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x1.1, %sin.7), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %149 : Half(1, 32, 64, 64, strides=[131072, 4096, 64, 1], requires_grad=1, device=cpu) = aten::add(%147, %148, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %150 : Tensor[] = prim::ListConstruct(%146, %149), scope: __module.model.model
  %rotated.1 : Half(1, 32, 64, 128, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::cat(%150, %29), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:938:0
  %query_states : Half(1, 32, 64, 128, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::to(%rotated.1, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:944:0
  %x.7 : Half(1, 8, 64, 128, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::contiguous(%x.5, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:919:0
  %154 : int = aten::size(%x.7, %32), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:920:0
  %155 : Long(device=cpu) = prim::NumToTensor(%154), scope: __module.model.model
  %half_dim : Long(requires_grad=0, device=cpu) = aten::floor_divide(%155, %30), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/_tensor.py:1137:0
  %157 : int = aten::Int(%half_dim), scope: __module.model.model
  %158 : int = aten::Int(%half_dim), scope: __module.model.model
  %159 : int = aten::Int(%half_dim), scope: __module.model.model
  %160 : int = aten::Int(%half_dim), scope: __module.model.model
  %x1 : Half(1, 8, 64, 64, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::slice(%x.7, %32, %46, %160, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:922:0
  %x2 : Half(1, 8, 64, 64, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::slice(%x.7, %32, %159, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:923:0
  %cos : Half(1, 1, 64, 64, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::slice(%cos.5, %32, %46, %158, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:931:0
  %sin : Half(1, 1, 64, 64, strides=[8192, 128, 128, 1], requires_grad=0, device=cpu) = aten::slice(%sin.5, %32, %46, %157, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:932:0
  %165 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x1, %cos), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %166 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x2, %sin), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %167 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::sub(%165, %166, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:939:0
  %168 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x2, %cos), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %169 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::mul(%x1, %sin), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %170 : Half(1, 8, 64, 64, strides=[32768, 4096, 64, 1], requires_grad=1, device=cpu) = aten::add(%168, %169, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:940:0
  %171 : Tensor[] = prim::ListConstruct(%167, %170), scope: __module.model.model
  %rotated : Half(1, 8, 64, 128, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::cat(%171, %29), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:938:0
  %key_states.3 : Half(1, 8, 64, 128, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::to(%rotated, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:944:0
  %174 : Half(1, 32, 64, 128, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::to(%query_states, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:787:0
  %key_states : Half(1, 8, 64, 128, strides=[65536, 8192, 128, 1], requires_grad=1, device=cpu) = aten::to(%key_states.3, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:787:0
  %value_states : Half(1, 8, 64, 128, strides=[1024, 128, 1024, 1], requires_grad=1, device=cpu) = aten::to(%value_states.3, %39, %38, %38, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:787:0
  %177 : int = aten::size(%key_states, %34), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1280:0
  %seq_length : Long(device=cpu) = prim::NumToTensor(%177), scope: __module.model.model
  %179 : Long(1, strides=[1], requires_grad=0, device=cpu) = aten::add(%current_pos, %seq_length, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %180 : int = aten::Int(%179), scope: __module.model.model
  %181 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=0, device=cpu) = aten::slice(%kv_cache_0, %46, %46, %43, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %182 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=0, device=cpu) = aten::slice(%181, %43, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %183 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=0, device=cpu) = aten::slice(%182, %34, %8, %180, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %184 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=0, device=cpu) = aten::slice(%183, %32, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %185 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::copy_(%184, %key_states, %38), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1281:0
  %186 : Long(1, strides=[1], requires_grad=0, device=cpu) = aten::add(%current_pos, %seq_length, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %187 : int = aten::Int(%186), scope: __module.model.model
  %188 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%kv_cache_0, %46, %34, %32, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %189 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%188, %43, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %190 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%189, %34, %7, %187, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %191 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%190, %32, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %192 : Half(1, 8, 64, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::copy_(%191, %value_states, %38), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1282:0
  %193 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%kv_cache_0, %46, %46, %43, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1285:0
  %K_layer_cache : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::squeeze(%193, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1285:0
  %195 : Half(1, 8, 512, 128, strides=[524288, 65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%kv_cache_0, %46, %34, %32, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1286:0
  %V_layer_cache : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::squeeze(%195, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1286:0
  %197 : int = aten::size(%hidden_states.3, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1001:0
  %198 : int = aten::size(%hidden_states.3, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1001:0
  %199 : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%K_layer_cache, %43, %46, %28, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1007:0
  %x.9 : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%199, %34, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1007:0
  %201 : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%V_layer_cache, %43, %46, %28, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1008:0
  %x.15 : Half(8, 512, 128, strides=[65536, 128, 1], requires_grad=1, device=cpu) = aten::slice(%201, %34, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1008:0
  %x.11 : Half(8, 1, 512, 128, strides=[65536, 65536, 128, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%x.9, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1068:0
  %204 : int[] = prim::ListConstruct(%43, %27, %43, %43), scope: __module.model.model
  %x.13 : Half(8, 4, 512, 128, strides=[262144, 65536, 128, 1], requires_grad=1, device=cpu) = aten::repeat(%x.11, %204), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1069:0
  %206 : int = aten::size(%x.13, %26), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %207 : int = aten::size(%x.13, %29), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %208 : int[] = prim::ListConstruct(%43, %29, %206, %207), scope: __module.model.model
  %209 : Half(1, 32, 512, 128, strides=[2097152, 65536, 128, 1], requires_grad=1, device=cpu) = aten::view(%x.13, %208), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %x.17 : Half(8, 1, 512, 128, strides=[65536, 65536, 128, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%x.15, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1068:0
  %211 : int[] = prim::ListConstruct(%43, %27, %43, %43), scope: __module.model.model
  %x.19 : Half(8, 4, 512, 128, strides=[262144, 65536, 128, 1], requires_grad=1, device=cpu) = aten::repeat(%x.17, %211), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1069:0
  %213 : int = aten::size(%x.19, %26), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %214 : int = aten::size(%x.19, %29), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %215 : int[] = prim::ListConstruct(%43, %29, %213, %214), scope: __module.model.model
  %216 : Half(1, 32, 512, 128, strides=[2097152, 65536, 128, 1], requires_grad=1, device=cpu) = aten::view(%x.19, %215), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1070:0
  %217 : Tensor[] = prim::ListConstruct(%174, %209), scope: __module.model.model
  %218 : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::einsum(%25, %217, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/functional.py:422:0
  %attn_weights : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::div(%218, %24), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1034:0
  %220 : Half(1, 1, 64, 512, strides=[32768, 32768, 512, 1], requires_grad=0, device=cpu) = aten::slice(%causal_mask, %46, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1040:0
  %221 : Half(1, 1, 64, 512, strides=[32768, 32768, 512, 1], requires_grad=0, device=cpu) = aten::slice(%220, %43, %46, %44, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1040:0
  %222 : Half(1, 1, 64, 512, strides=[32768, 32768, 512, 1], requires_grad=0, device=cpu) = aten::slice(%221, %34, %46, %28, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1040:0
  %x.21 : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::add(%attn_weights, %222, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1040:0
  %x_max : Half(1, 32, 64, 1, strides=[2048, 64, 1, 1], requires_grad=1, device=cpu), %225 : Long(1, 32, 64, 1, strides=[2048, 64, 1, 1], requires_grad=0, device=cpu) = aten::max(%x.21, %29, %37), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:896:0
  %x : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::sub(%x.21, %x_max, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:897:0
  %exp_x : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::exp(%x), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:898:0
  %228 : int[] = prim::ListConstruct(%29), scope: __module.model.model
  %229 : Half(1, 32, 64, 1, strides=[2048, 64, 1, 1], requires_grad=1, device=cpu) = aten::sum(%exp_x, %228, %37, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:899:0
  %230 : Half(1, 32, 64, 512, strides=[1048576, 32768, 512, 1], requires_grad=1, device=cpu) = aten::div(%exp_x, %229), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:899:0
  %231 : Tensor[] = prim::ListConstruct(%230, %216), scope: __module.model.model
  %attn_output.1 : Half(1, 32, 64, 128, strides=[262144, 8192, 128, 1], requires_grad=1, device=cpu) = aten::einsum(%23, %231, %42), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/functional.py:422:0
  %233 : Half(1, 64, 32, 128, strides=[262144, 128, 8192, 1], requires_grad=1, device=cpu) = aten::transpose(%attn_output.1, %43, %34), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1054:0
  %attn_output.3 : Half(1, 64, 32, 128, strides=[262144, 4096, 128, 1], requires_grad=1, device=cpu) = aten::contiguous(%233, %46), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1054:0
  %235 : int[] = prim::ListConstruct(%197, %198, %35), scope: __module.model.model
  %input.3 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::reshape(%attn_output.3, %235), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1055:0
  %bias.19 : Tensor = prim::GetAttr[name="bias"](%o_proj)
  %weight.117 : Tensor = prim::GetAttr[name="weight"](%o_proj)
  %attn_output : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::linear(%input.3, %weight.117, %bias.19), scope: __module.model.model/__module.model.model.layers.0.self_attn.o_proj # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/linear.py:125:0
  %input.5 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::add(%hidden_states.1, %attn_output, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1296:0
  %bias : Tensor = prim::GetAttr[name="bias"](%post_attention_layernorm)
  %weight.119 : Tensor = prim::GetAttr[name="weight"](%post_attention_layernorm)
  %243 : int[] = prim::ListConstruct(%35), scope: __module.model.model/__module.model.model.layers.0.post_attention_layernorm
  %hidden_states.5 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::layer_norm(%input.5, %243, %weight.119, %bias, %36, %37), scope: __module.model.model/__module.model.model.layers.0.post_attention_layernorm # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2910:0
  %experts : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_15 : __torch__.anemll.models.phimoe_model.___torch_mangle_65.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="15"](%experts)
  %experts.29 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_14 : __torch__.anemll.models.phimoe_model.___torch_mangle_61.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="14"](%experts.29)
  %experts.27 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_13 : __torch__.anemll.models.phimoe_model.___torch_mangle_57.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="13"](%experts.27)
  %experts.25 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_12 : __torch__.anemll.models.phimoe_model.___torch_mangle_53.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="12"](%experts.25)
  %experts.23 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_11 : __torch__.anemll.models.phimoe_model.___torch_mangle_49.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="11"](%experts.23)
  %experts.21 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_10 : __torch__.anemll.models.phimoe_model.___torch_mangle_45.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="10"](%experts.21)
  %experts.19 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_9 : __torch__.anemll.models.phimoe_model.___torch_mangle_41.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="9"](%experts.19)
  %experts.17 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_8 : __torch__.anemll.models.phimoe_model.___torch_mangle_37.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="8"](%experts.17)
  %experts.15 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_7 : __torch__.anemll.models.phimoe_model.___torch_mangle_33.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="7"](%experts.15)
  %experts.13 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_6 : __torch__.anemll.models.phimoe_model.___torch_mangle_29.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="6"](%experts.13)
  %experts.11 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_5 : __torch__.anemll.models.phimoe_model.___torch_mangle_25.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="5"](%experts.11)
  %experts.9 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_4 : __torch__.anemll.models.phimoe_model.___torch_mangle_21.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="4"](%experts.9)
  %experts.7 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_3 : __torch__.anemll.models.phimoe_model.___torch_mangle_17.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="3"](%experts.7)
  %experts.5 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_2 : __torch__.anemll.models.phimoe_model.___torch_mangle_13.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="2"](%experts.5)
  %experts.3 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_1 : __torch__.anemll.models.phimoe_model.___torch_mangle_9.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="1"](%experts.3)
  %experts.1 : __torch__.torch.nn.modules.container.ModuleList = prim::GetAttr[name="experts"](%block_sparse_moe)
  %_0.13 : __torch__.anemll.models.phimoe_model.PhimoeBlockSparseTop2MLP = prim::GetAttr[name="0"](%experts.1)
  %gate : __torch__.torch.nn.modules.conv.___torch_mangle_2.Conv2d = prim::GetAttr[name="gate"](%block_sparse_moe)
  %278 : int = aten::size(%hidden_states.5, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:593:0
  %batch_size : Long(device=cpu) = prim::NumToTensor(%278), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %280 : int = aten::size(%hidden_states.5, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:593:0
  %sequence_length : Long(device=cpu) = prim::NumToTensor(%280), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %282 : int = aten::size(%hidden_states.5, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:593:0
  %283 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.7 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.5, %283), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:599:0
  %285 : Long(requires_grad=0, device=cpu) = aten::mul(%batch_size, %sequence_length), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:602:0
  %286 : int = aten::Int(%285), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %287 : int[] = prim::ListConstruct(%286, %282, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %input.7 : Half(64, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.7, %287), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:602:0
  %weight.121 : Tensor = prim::GetAttr[name="weight"](%gate)
  %290 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.gate
  %291 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.gate
  %292 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.gate
  %293 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.gate
  %router_logits : Half(64, 16, 1, 1, strides=[16, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.7, %weight.121, %42, %290, %291, %292, %38, %293, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.gate # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %295 : Long(requires_grad=0, device=cpu) = aten::mul(%batch_size, %sequence_length), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:604:0
  %296 : int = aten::Int(%295), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %297 : int[] = prim::ListConstruct(%296, %10), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %scores : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::view(%router_logits, %297), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:604:0
  %mask_logits_threshold.1 : Half(64, 1, strides=[1, 1], requires_grad=0, device=cpu), %max_ind.1 : Long(64, 1, strides=[1, 1], requires_grad=0, device=cpu) = aten::max(%scores, %29, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:410:0
  %301 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::abs(%scores), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:411:0
  %factor.1 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::clamp(%301, %mask_logits_threshold.1, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:411:0
  %303 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::sub(%mask_logits_threshold.1, %scores, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:412:0
  %304 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::div(%303, %factor.1), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:412:0
  %mask_logits_threshold.3 : Bool(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::gt(%304, %11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:412:0
  %masked_gates.1 : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::masked_fill(%scores, %mask_logits_threshold.3, %12), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:415:0
  %masked_gates : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::softmax(%masked_gates.1, %29, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:430:0
  %multiplier_o : Half(64, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::gather(%masked_gates, %29, %max_ind.1, %38), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:431:0
  %masked_scores : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::scatter(%scores, %29, %max_ind.1, %12), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:455:0
  %mask_logits_threshold.5 : Half(64, 1, strides=[1, 1], requires_grad=0, device=cpu), %max_ind : Long(64, 1, strides=[1, 1], requires_grad=0, device=cpu) = aten::max(%masked_scores, %29, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:463:0
  %312 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::abs(%scores), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:464:0
  %factor : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::clamp(%312, %mask_logits_threshold.5, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:464:0
  %314 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::sub(%mask_logits_threshold.5, %scores, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:465:0
  %315 : Half(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::div(%314, %factor), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:465:0
  %mask_logits_threshold : Bool(64, 16, strides=[16, 1], requires_grad=0, device=cpu) = aten::gt(%315, %11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:465:0
  %masked_gates_top2.1 : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::masked_fill(%masked_scores, %mask_logits_threshold, %12), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:468:0
  %masked_gates_top2 : Half(64, 16, strides=[16, 1], requires_grad=1, device=cpu) = aten::softmax(%masked_gates_top2.1, %29, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:484:0
  %multiplier_top2_o : Half(64, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::gather(%masked_gates_top2, %29, %max_ind, %38), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:485:0
  %320 : Tensor[] = prim::ListConstruct(%multiplier_o, %multiplier_top2_o), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %routing_weights : Half(64, 2, strides=[2, 1], requires_grad=1, device=cpu) = aten::concat(%320, %29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:508:0
  %322 : Tensor[] = prim::ListConstruct(%max_ind.1, %max_ind), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %selected_experts : Long(64, 2, strides=[2, 1], requires_grad=0, device=cpu) = aten::concat(%322, %29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:509:0
  %324 : Long(requires_grad=0, device=cpu) = aten::mul(%batch_size, %sequence_length), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:616:0
  %325 : int = aten::Int(%324), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %326 : int[] = prim::ListConstruct(%325, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %final_hidden_states.1 : Half(64, 4096, strides=[4096, 1], requires_grad=0, device=cpu) = aten::zeros(%326, %39, %42, %13, %38), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:615:0
  %328 : Long(64, 2, 16, strides=[32, 16, 1], requires_grad=0, device=cpu) = aten::one_hot(%selected_experts, %10), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:621:0
  %329 : int[] = prim::ListConstruct(%34, %43, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %expert_mask : Long(16, 2, 64, strides=[1, 16, 32], requires_grad=0, device=cpu) = aten::permute(%328, %329), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:621:0
  %331 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %332 : Tensor[] = aten::where(%331), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.1 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.1 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%332), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %335 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %336 : Tensor?[] = prim::ListConstruct(%42, %top_x.1), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %337 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%335, %336), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %338 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.9 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%337, %338), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.1 : __torch__.torch.nn.modules.conv.___torch_mangle_4.Conv2d = prim::GetAttr[name="w2"](%_0.13)
  %w3.1 : __torch__.torch.nn.modules.conv.___torch_mangle_5.Conv2d = prim::GetAttr[name="w3"](%_0.13)
  %w1.1 : __torch__.torch.nn.modules.conv.___torch_mangle_3.Conv2d = prim::GetAttr[name="w1"](%_0.13)
  %343 : int = aten::size(%hidden_states.9, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %344 : int = aten::size(%hidden_states.9, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %345 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0
  %input.9 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.9, %345), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.123 : Tensor = prim::GetAttr[name="weight"](%w1.1)
  %348 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w1
  %349 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w1
  %350 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w1
  %351 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w1
  %input.11 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.9, %weight.123, %42, %348, %349, %350, %38, %351, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %353 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.125 : Tensor = prim::GetAttr[name="weight"](%w3.1)
  %355 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w3
  %356 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w3
  %357 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w3
  %358 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w3
  %359 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.9, %weight.125, %42, %355, %356, %357, %38, %358, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.13 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%353, %359), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.127 : Tensor = prim::GetAttr[name="weight"](%w2.1)
  %362 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w2
  %363 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w2
  %364 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w2
  %365 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w2
  %out.1 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.13, %weight.127, %42, %362, %363, %364, %38, %365, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0/__module.model.model.layers.0.block_sparse_moe.experts.0.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %367 : int[] = prim::ListConstruct(%343, %344), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0
  %368 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.1, %367), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.0 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %369 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %370 : Tensor?[] = prim::ListConstruct(%top_x.1, %idx.1), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %371 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%369, %370), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.1 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%368, %371), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %373 : int = aten::size(%final_hidden_states.1, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %374 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.1, %373), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.1 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%374, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %376 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.1), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.1 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%376, %current_hidden_states.1), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.3 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.1, %contributions.1, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %379 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %380 : Tensor[] = aten::where(%379), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.3 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.3 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%380), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %383 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %384 : Tensor?[] = prim::ListConstruct(%42, %top_x.3), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %385 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%383, %384), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %386 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.11 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%385, %386), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.3 : __torch__.torch.nn.modules.conv.___torch_mangle_7.Conv2d = prim::GetAttr[name="w2"](%_1)
  %w3.3 : __torch__.torch.nn.modules.conv.___torch_mangle_8.Conv2d = prim::GetAttr[name="w3"](%_1)
  %w1.3 : __torch__.torch.nn.modules.conv.___torch_mangle_6.Conv2d = prim::GetAttr[name="w1"](%_1)
  %391 : int = aten::size(%hidden_states.11, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %392 : int = aten::size(%hidden_states.11, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %393 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1
  %input.15 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.11, %393), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.129 : Tensor = prim::GetAttr[name="weight"](%w1.3)
  %396 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w1
  %397 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w1
  %398 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w1
  %399 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w1
  %input.17 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.15, %weight.129, %42, %396, %397, %398, %38, %399, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %401 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.131 : Tensor = prim::GetAttr[name="weight"](%w3.3)
  %403 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w3
  %404 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w3
  %405 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w3
  %406 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w3
  %407 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.15, %weight.131, %42, %403, %404, %405, %38, %406, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.19 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%401, %407), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.133 : Tensor = prim::GetAttr[name="weight"](%w2.3)
  %410 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w2
  %411 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w2
  %412 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w2
  %413 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w2
  %out.3 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.19, %weight.133, %42, %410, %411, %412, %38, %413, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1/__module.model.model.layers.0.block_sparse_moe.experts.1.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %415 : int[] = prim::ListConstruct(%391, %392), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1
  %416 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.3, %415), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.1 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %417 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %418 : Tensor?[] = prim::ListConstruct(%top_x.3, %idx.3), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %419 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%417, %418), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.3 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%416, %419), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %421 : int = aten::size(%final_hidden_states.3, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %422 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.3, %421), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.3 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%422, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %424 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.3), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.3 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%424, %current_hidden_states.3), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.5 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.3, %contributions.3, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %427 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %428 : Tensor[] = aten::where(%427), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.5 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.5 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%428), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %431 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %432 : Tensor?[] = prim::ListConstruct(%42, %top_x.5), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %433 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%431, %432), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %434 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.13 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%433, %434), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.5 : __torch__.torch.nn.modules.conv.___torch_mangle_11.Conv2d = prim::GetAttr[name="w2"](%_2)
  %w3.5 : __torch__.torch.nn.modules.conv.___torch_mangle_12.Conv2d = prim::GetAttr[name="w3"](%_2)
  %w1.5 : __torch__.torch.nn.modules.conv.___torch_mangle_10.Conv2d = prim::GetAttr[name="w1"](%_2)
  %439 : int = aten::size(%hidden_states.13, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %440 : int = aten::size(%hidden_states.13, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %441 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2
  %input.21 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.13, %441), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.135 : Tensor = prim::GetAttr[name="weight"](%w1.5)
  %444 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w1
  %445 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w1
  %446 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w1
  %447 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w1
  %input.23 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.21, %weight.135, %42, %444, %445, %446, %38, %447, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %449 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.23), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.137 : Tensor = prim::GetAttr[name="weight"](%w3.5)
  %451 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w3
  %452 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w3
  %453 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w3
  %454 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w3
  %455 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.21, %weight.137, %42, %451, %452, %453, %38, %454, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.25 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%449, %455), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.139 : Tensor = prim::GetAttr[name="weight"](%w2.5)
  %458 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w2
  %459 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w2
  %460 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w2
  %461 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w2
  %out.5 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.25, %weight.139, %42, %458, %459, %460, %38, %461, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2/__module.model.model.layers.0.block_sparse_moe.experts.2.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %463 : int[] = prim::ListConstruct(%439, %440), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2
  %464 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.5, %463), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.2 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %465 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %466 : Tensor?[] = prim::ListConstruct(%top_x.5, %idx.5), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %467 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%465, %466), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.5 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%464, %467), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %469 : int = aten::size(%final_hidden_states.5, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %470 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.5, %469), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.5 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%470, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %472 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.5), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.5 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%472, %current_hidden_states.5), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.7 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.5, %contributions.5, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %475 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %32), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %476 : Tensor[] = aten::where(%475), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.7 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.7 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%476), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %479 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %480 : Tensor?[] = prim::ListConstruct(%42, %top_x.7), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %481 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%479, %480), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %482 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.15 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%481, %482), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.7 : __torch__.torch.nn.modules.conv.___torch_mangle_15.Conv2d = prim::GetAttr[name="w2"](%_3)
  %w3.7 : __torch__.torch.nn.modules.conv.___torch_mangle_16.Conv2d = prim::GetAttr[name="w3"](%_3)
  %w1.7 : __torch__.torch.nn.modules.conv.___torch_mangle_14.Conv2d = prim::GetAttr[name="w1"](%_3)
  %487 : int = aten::size(%hidden_states.15, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %488 : int = aten::size(%hidden_states.15, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %489 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3
  %input.27 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.15, %489), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.141 : Tensor = prim::GetAttr[name="weight"](%w1.7)
  %492 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w1
  %493 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w1
  %494 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w1
  %495 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w1
  %input.29 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.27, %weight.141, %42, %492, %493, %494, %38, %495, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %497 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.143 : Tensor = prim::GetAttr[name="weight"](%w3.7)
  %499 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w3
  %500 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w3
  %501 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w3
  %502 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w3
  %503 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.27, %weight.143, %42, %499, %500, %501, %38, %502, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.31 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%497, %503), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.145 : Tensor = prim::GetAttr[name="weight"](%w2.7)
  %506 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w2
  %507 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w2
  %508 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w2
  %509 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w2
  %out.7 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.31, %weight.145, %42, %506, %507, %508, %38, %509, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3/__module.model.model.layers.0.block_sparse_moe.experts.3.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %511 : int[] = prim::ListConstruct(%487, %488), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3
  %512 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.7, %511), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.3 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %513 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %514 : Tensor?[] = prim::ListConstruct(%top_x.7, %idx.7), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %515 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%513, %514), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.7 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%512, %515), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %517 : int = aten::size(%final_hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %518 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.7, %517), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.7 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%518, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %520 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.7), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.7 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%520, %current_hidden_states.7), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.9 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.7, %contributions.7, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %523 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %27), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %524 : Tensor[] = aten::where(%523), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.9 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.9 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%524), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %527 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %528 : Tensor?[] = prim::ListConstruct(%42, %top_x.9), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %529 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%527, %528), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %530 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.17 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%529, %530), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.9 : __torch__.torch.nn.modules.conv.___torch_mangle_19.Conv2d = prim::GetAttr[name="w2"](%_4)
  %w3.9 : __torch__.torch.nn.modules.conv.___torch_mangle_20.Conv2d = prim::GetAttr[name="w3"](%_4)
  %w1.9 : __torch__.torch.nn.modules.conv.___torch_mangle_18.Conv2d = prim::GetAttr[name="w1"](%_4)
  %535 : int = aten::size(%hidden_states.17, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %536 : int = aten::size(%hidden_states.17, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %537 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4
  %input.33 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.17, %537), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.147 : Tensor = prim::GetAttr[name="weight"](%w1.9)
  %540 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w1
  %541 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w1
  %542 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w1
  %543 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w1
  %input.35 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.33, %weight.147, %42, %540, %541, %542, %38, %543, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %545 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.35), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.149 : Tensor = prim::GetAttr[name="weight"](%w3.9)
  %547 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w3
  %548 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w3
  %549 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w3
  %550 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w3
  %551 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.33, %weight.149, %42, %547, %548, %549, %38, %550, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.37 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%545, %551), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.151 : Tensor = prim::GetAttr[name="weight"](%w2.9)
  %554 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w2
  %555 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w2
  %556 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w2
  %557 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w2
  %out.9 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.37, %weight.151, %42, %554, %555, %556, %38, %557, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4/__module.model.model.layers.0.block_sparse_moe.experts.4.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %559 : int[] = prim::ListConstruct(%535, %536), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4
  %560 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.9, %559), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.4 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %561 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %562 : Tensor?[] = prim::ListConstruct(%top_x.9, %idx.9), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %563 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%561, %562), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.9 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%560, %563), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %565 : int = aten::size(%final_hidden_states.9, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %566 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.9, %565), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.9 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%566, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %568 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.9), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.9 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%568, %current_hidden_states.9), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.11 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.9, %contributions.9, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %571 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %39), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %572 : Tensor[] = aten::where(%571), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.11 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.11 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%572), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %575 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %576 : Tensor?[] = prim::ListConstruct(%42, %top_x.11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %577 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%575, %576), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %578 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.19 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%577, %578), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.11 : __torch__.torch.nn.modules.conv.___torch_mangle_23.Conv2d = prim::GetAttr[name="w2"](%_5)
  %w3.11 : __torch__.torch.nn.modules.conv.___torch_mangle_24.Conv2d = prim::GetAttr[name="w3"](%_5)
  %w1.11 : __torch__.torch.nn.modules.conv.___torch_mangle_22.Conv2d = prim::GetAttr[name="w1"](%_5)
  %583 : int = aten::size(%hidden_states.19, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %584 : int = aten::size(%hidden_states.19, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %585 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5
  %input.39 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.19, %585), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.153 : Tensor = prim::GetAttr[name="weight"](%w1.11)
  %588 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w1
  %589 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w1
  %590 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w1
  %591 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w1
  %input.41 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.39, %weight.153, %42, %588, %589, %590, %38, %591, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %593 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.41), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.155 : Tensor = prim::GetAttr[name="weight"](%w3.11)
  %595 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w3
  %596 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w3
  %597 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w3
  %598 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w3
  %599 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.39, %weight.155, %42, %595, %596, %597, %38, %598, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.43 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%593, %599), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.157 : Tensor = prim::GetAttr[name="weight"](%w2.11)
  %602 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w2
  %603 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w2
  %604 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w2
  %605 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w2
  %out.11 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.43, %weight.157, %42, %602, %603, %604, %38, %605, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5/__module.model.model.layers.0.block_sparse_moe.experts.5.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %607 : int[] = prim::ListConstruct(%583, %584), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5
  %608 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.11, %607), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.5 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %609 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %610 : Tensor?[] = prim::ListConstruct(%top_x.11, %idx.11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %611 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%609, %610), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.11 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%608, %611), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %613 : int = aten::size(%final_hidden_states.11, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %614 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.11, %613), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.11 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%614, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %616 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.11 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%616, %current_hidden_states.11), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.13 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.11, %contributions.11, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %619 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %14), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %620 : Tensor[] = aten::where(%619), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.13 : Long(64, strides=[1], requires_grad=0, device=cpu), %top_x.13 : Long(64, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%620), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %623 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %624 : Tensor?[] = prim::ListConstruct(%42, %top_x.13), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %625 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::index(%623, %624), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %626 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.21 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%625, %626), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.13 : __torch__.torch.nn.modules.conv.___torch_mangle_27.Conv2d = prim::GetAttr[name="w2"](%_6)
  %w3.13 : __torch__.torch.nn.modules.conv.___torch_mangle_28.Conv2d = prim::GetAttr[name="w3"](%_6)
  %w1.13 : __torch__.torch.nn.modules.conv.___torch_mangle_26.Conv2d = prim::GetAttr[name="w1"](%_6)
  %631 : int = aten::size(%hidden_states.21, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %632 : int = aten::size(%hidden_states.21, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %633 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6
  %input.45 : Half(64, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.21, %633), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.159 : Tensor = prim::GetAttr[name="weight"](%w1.13)
  %636 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w1
  %637 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w1
  %638 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w1
  %639 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w1
  %input.47 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.45, %weight.159, %42, %636, %637, %638, %38, %639, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %641 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.47), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.161 : Tensor = prim::GetAttr[name="weight"](%w3.13)
  %643 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w3
  %644 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w3
  %645 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w3
  %646 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w3
  %647 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.45, %weight.161, %42, %643, %644, %645, %38, %646, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.49 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%641, %647), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.163 : Tensor = prim::GetAttr[name="weight"](%w2.13)
  %650 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w2
  %651 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w2
  %652 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w2
  %653 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w2
  %out.13 : Half(64, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.49, %weight.163, %42, %650, %651, %652, %38, %653, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6/__module.model.model.layers.0.block_sparse_moe.experts.6.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %655 : int[] = prim::ListConstruct(%631, %632), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6
  %656 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.13, %655), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.6 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %657 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %658 : Tensor?[] = prim::ListConstruct(%top_x.13, %idx.13), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %659 : Half(64, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%657, %658), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.13 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%656, %659), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %661 : int = aten::size(%final_hidden_states.13, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %662 : Long(64, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.13, %661), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.13 : Half(64, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%662, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %664 : Half(64, 64, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.13), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.13 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%664, %current_hidden_states.13), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.15 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.13, %contributions.13, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %667 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %15), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %668 : Tensor[] = aten::where(%667), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.15 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.15 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%668), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %671 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %672 : Tensor?[] = prim::ListConstruct(%42, %top_x.15), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %673 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%671, %672), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %674 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.23 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%673, %674), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.15 : __torch__.torch.nn.modules.conv.___torch_mangle_31.Conv2d = prim::GetAttr[name="w2"](%_7)
  %w3.15 : __torch__.torch.nn.modules.conv.___torch_mangle_32.Conv2d = prim::GetAttr[name="w3"](%_7)
  %w1.15 : __torch__.torch.nn.modules.conv.___torch_mangle_30.Conv2d = prim::GetAttr[name="w1"](%_7)
  %679 : int = aten::size(%hidden_states.23, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %680 : int = aten::size(%hidden_states.23, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %681 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7
  %input.51 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.23, %681), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.165 : Tensor = prim::GetAttr[name="weight"](%w1.15)
  %684 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w1
  %685 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w1
  %686 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w1
  %687 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w1
  %input.53 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.51, %weight.165, %42, %684, %685, %686, %38, %687, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %689 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.53), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.167 : Tensor = prim::GetAttr[name="weight"](%w3.15)
  %691 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w3
  %692 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w3
  %693 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w3
  %694 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w3
  %695 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.51, %weight.167, %42, %691, %692, %693, %38, %694, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.55 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%689, %695), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.169 : Tensor = prim::GetAttr[name="weight"](%w2.15)
  %698 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w2
  %699 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w2
  %700 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w2
  %701 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w2
  %out.15 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.55, %weight.169, %42, %698, %699, %700, %38, %701, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7/__module.model.model.layers.0.block_sparse_moe.experts.7.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %703 : int[] = prim::ListConstruct(%679, %680), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7
  %704 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.15, %703), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.7 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %705 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %706 : Tensor?[] = prim::ListConstruct(%top_x.15, %idx.15), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %707 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%705, %706), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.15 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%704, %707), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %709 : int = aten::size(%final_hidden_states.15, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %710 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.15, %709), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.15 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%710, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %712 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.15), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.15 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%712, %current_hidden_states.15), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.17 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.15, %contributions.15, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %715 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %31), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %716 : Tensor[] = aten::where(%715), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.17 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.17 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%716), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %719 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %720 : Tensor?[] = prim::ListConstruct(%42, %top_x.17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %721 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%719, %720), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %722 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.25 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%721, %722), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.17 : __torch__.torch.nn.modules.conv.___torch_mangle_35.Conv2d = prim::GetAttr[name="w2"](%_8)
  %w3.17 : __torch__.torch.nn.modules.conv.___torch_mangle_36.Conv2d = prim::GetAttr[name="w3"](%_8)
  %w1.17 : __torch__.torch.nn.modules.conv.___torch_mangle_34.Conv2d = prim::GetAttr[name="w1"](%_8)
  %727 : int = aten::size(%hidden_states.25, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %728 : int = aten::size(%hidden_states.25, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %729 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8
  %input.57 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.25, %729), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.171 : Tensor = prim::GetAttr[name="weight"](%w1.17)
  %732 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w1
  %733 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w1
  %734 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w1
  %735 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w1
  %input.59 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.57, %weight.171, %42, %732, %733, %734, %38, %735, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %737 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.59), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.173 : Tensor = prim::GetAttr[name="weight"](%w3.17)
  %739 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w3
  %740 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w3
  %741 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w3
  %742 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w3
  %743 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.57, %weight.173, %42, %739, %740, %741, %38, %742, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.61 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%737, %743), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.175 : Tensor = prim::GetAttr[name="weight"](%w2.17)
  %746 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w2
  %747 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w2
  %748 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w2
  %749 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w2
  %out.17 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.61, %weight.175, %42, %746, %747, %748, %38, %749, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8/__module.model.model.layers.0.block_sparse_moe.experts.8.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %751 : int[] = prim::ListConstruct(%727, %728), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8
  %752 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.17, %751), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.8 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %753 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %754 : Tensor?[] = prim::ListConstruct(%top_x.17, %idx.17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %755 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%753, %754), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.17 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%752, %755), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %757 : int = aten::size(%final_hidden_states.17, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %758 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.17, %757), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.17 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%758, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %760 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.17 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%760, %current_hidden_states.17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.19 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.17, %contributions.17, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %763 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %16), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %764 : Tensor[] = aten::where(%763), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.19 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.19 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%764), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %767 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %768 : Tensor?[] = prim::ListConstruct(%42, %top_x.19), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %769 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%767, %768), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %770 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.27 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%769, %770), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.19 : __torch__.torch.nn.modules.conv.___torch_mangle_39.Conv2d = prim::GetAttr[name="w2"](%_9)
  %w3.19 : __torch__.torch.nn.modules.conv.___torch_mangle_40.Conv2d = prim::GetAttr[name="w3"](%_9)
  %w1.19 : __torch__.torch.nn.modules.conv.___torch_mangle_38.Conv2d = prim::GetAttr[name="w1"](%_9)
  %775 : int = aten::size(%hidden_states.27, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %776 : int = aten::size(%hidden_states.27, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %777 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9
  %input.63 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.27, %777), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.177 : Tensor = prim::GetAttr[name="weight"](%w1.19)
  %780 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w1
  %781 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w1
  %782 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w1
  %783 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w1
  %input.65 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.63, %weight.177, %42, %780, %781, %782, %38, %783, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %785 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.65), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.179 : Tensor = prim::GetAttr[name="weight"](%w3.19)
  %787 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w3
  %788 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w3
  %789 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w3
  %790 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w3
  %791 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.63, %weight.179, %42, %787, %788, %789, %38, %790, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.67 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%785, %791), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.181 : Tensor = prim::GetAttr[name="weight"](%w2.19)
  %794 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w2
  %795 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w2
  %796 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w2
  %797 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w2
  %out.19 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.67, %weight.181, %42, %794, %795, %796, %38, %797, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9/__module.model.model.layers.0.block_sparse_moe.experts.9.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %799 : int[] = prim::ListConstruct(%775, %776), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9
  %800 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.19, %799), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.9 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %801 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %802 : Tensor?[] = prim::ListConstruct(%top_x.19, %idx.19), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %803 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%801, %802), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.19 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%800, %803), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %805 : int = aten::size(%final_hidden_states.19, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %806 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.19, %805), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.19 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%806, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %808 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.19), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.19 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%808, %current_hidden_states.19), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.21 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.19, %contributions.19, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %811 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %17), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %812 : Tensor[] = aten::where(%811), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.21 : Long(64, strides=[1], requires_grad=0, device=cpu), %top_x.21 : Long(64, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%812), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %815 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %816 : Tensor?[] = prim::ListConstruct(%42, %top_x.21), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %817 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::index(%815, %816), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %818 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.29 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%817, %818), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.21 : __torch__.torch.nn.modules.conv.___torch_mangle_43.Conv2d = prim::GetAttr[name="w2"](%_10)
  %w3.21 : __torch__.torch.nn.modules.conv.___torch_mangle_44.Conv2d = prim::GetAttr[name="w3"](%_10)
  %w1.21 : __torch__.torch.nn.modules.conv.___torch_mangle_42.Conv2d = prim::GetAttr[name="w1"](%_10)
  %823 : int = aten::size(%hidden_states.29, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %824 : int = aten::size(%hidden_states.29, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %825 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10
  %input.69 : Half(64, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.29, %825), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.183 : Tensor = prim::GetAttr[name="weight"](%w1.21)
  %828 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w1
  %829 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w1
  %830 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w1
  %831 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w1
  %input.71 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.69, %weight.183, %42, %828, %829, %830, %38, %831, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %833 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.71), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.185 : Tensor = prim::GetAttr[name="weight"](%w3.21)
  %835 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w3
  %836 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w3
  %837 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w3
  %838 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w3
  %839 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.69, %weight.185, %42, %835, %836, %837, %38, %838, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.73 : Half(64, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%833, %839), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.187 : Tensor = prim::GetAttr[name="weight"](%w2.21)
  %842 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w2
  %843 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w2
  %844 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w2
  %845 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w2
  %out.21 : Half(64, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.73, %weight.187, %42, %842, %843, %844, %38, %845, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10/__module.model.model.layers.0.block_sparse_moe.experts.10.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %847 : int[] = prim::ListConstruct(%823, %824), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10
  %848 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.21, %847), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.10 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %849 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %850 : Tensor?[] = prim::ListConstruct(%top_x.21, %idx.21), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %851 : Half(64, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%849, %850), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.21 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%848, %851), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %853 : int = aten::size(%final_hidden_states.21, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %854 : Long(64, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.21, %853), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.21 : Half(64, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%854, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %856 : Half(64, 64, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.21), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.21 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%856, %current_hidden_states.21), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.23 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.21, %contributions.21, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %859 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %18), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %860 : Tensor[] = aten::where(%859), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.23 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.23 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%860), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %863 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %864 : Tensor?[] = prim::ListConstruct(%42, %top_x.23), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %865 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%863, %864), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %866 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.31 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%865, %866), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.23 : __torch__.torch.nn.modules.conv.___torch_mangle_47.Conv2d = prim::GetAttr[name="w2"](%_11)
  %w3.23 : __torch__.torch.nn.modules.conv.___torch_mangle_48.Conv2d = prim::GetAttr[name="w3"](%_11)
  %w1.23 : __torch__.torch.nn.modules.conv.___torch_mangle_46.Conv2d = prim::GetAttr[name="w1"](%_11)
  %871 : int = aten::size(%hidden_states.31, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %872 : int = aten::size(%hidden_states.31, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %873 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11
  %input.75 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.31, %873), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.189 : Tensor = prim::GetAttr[name="weight"](%w1.23)
  %876 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w1
  %877 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w1
  %878 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w1
  %879 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w1
  %input.77 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.75, %weight.189, %42, %876, %877, %878, %38, %879, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %881 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.77), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.191 : Tensor = prim::GetAttr[name="weight"](%w3.23)
  %883 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w3
  %884 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w3
  %885 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w3
  %886 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w3
  %887 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.75, %weight.191, %42, %883, %884, %885, %38, %886, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.79 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%881, %887), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.193 : Tensor = prim::GetAttr[name="weight"](%w2.23)
  %890 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w2
  %891 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w2
  %892 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w2
  %893 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w2
  %out.23 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.79, %weight.193, %42, %890, %891, %892, %38, %893, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11/__module.model.model.layers.0.block_sparse_moe.experts.11.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %895 : int[] = prim::ListConstruct(%871, %872), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11
  %896 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.23, %895), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.11 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %897 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %898 : Tensor?[] = prim::ListConstruct(%top_x.23, %idx.23), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %899 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%897, %898), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.23 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%896, %899), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %901 : int = aten::size(%final_hidden_states.23, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %902 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.23, %901), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.23 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%902, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %904 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.23), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.23 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%904, %current_hidden_states.23), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.25 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.23, %contributions.23, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %907 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %19), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %908 : Tensor[] = aten::where(%907), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.25 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.25 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%908), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %911 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %912 : Tensor?[] = prim::ListConstruct(%42, %top_x.25), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %913 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%911, %912), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %914 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.33 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%913, %914), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.25 : __torch__.torch.nn.modules.conv.___torch_mangle_51.Conv2d = prim::GetAttr[name="w2"](%_12)
  %w3.25 : __torch__.torch.nn.modules.conv.___torch_mangle_52.Conv2d = prim::GetAttr[name="w3"](%_12)
  %w1.25 : __torch__.torch.nn.modules.conv.___torch_mangle_50.Conv2d = prim::GetAttr[name="w1"](%_12)
  %919 : int = aten::size(%hidden_states.33, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %920 : int = aten::size(%hidden_states.33, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %921 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12
  %input.81 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.33, %921), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.195 : Tensor = prim::GetAttr[name="weight"](%w1.25)
  %924 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w1
  %925 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w1
  %926 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w1
  %927 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w1
  %input.83 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.81, %weight.195, %42, %924, %925, %926, %38, %927, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %929 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.83), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.197 : Tensor = prim::GetAttr[name="weight"](%w3.25)
  %931 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w3
  %932 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w3
  %933 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w3
  %934 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w3
  %935 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.81, %weight.197, %42, %931, %932, %933, %38, %934, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.85 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%929, %935), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.199 : Tensor = prim::GetAttr[name="weight"](%w2.25)
  %938 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w2
  %939 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w2
  %940 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w2
  %941 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w2
  %out.25 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.85, %weight.199, %42, %938, %939, %940, %38, %941, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12/__module.model.model.layers.0.block_sparse_moe.experts.12.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %943 : int[] = prim::ListConstruct(%919, %920), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12
  %944 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.25, %943), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.12 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %945 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %946 : Tensor?[] = prim::ListConstruct(%top_x.25, %idx.25), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %947 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%945, %946), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.25 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%944, %947), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %949 : int = aten::size(%final_hidden_states.25, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %950 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.25, %949), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.25 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%950, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %952 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.25), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.25 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%952, %current_hidden_states.25), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.27 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.25, %contributions.25, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %955 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %20), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %956 : Tensor[] = aten::where(%955), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.27 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.27 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%956), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %959 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %960 : Tensor?[] = prim::ListConstruct(%42, %top_x.27), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %961 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%959, %960), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %962 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.35 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%961, %962), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.27 : __torch__.torch.nn.modules.conv.___torch_mangle_55.Conv2d = prim::GetAttr[name="w2"](%_13)
  %w3.27 : __torch__.torch.nn.modules.conv.___torch_mangle_56.Conv2d = prim::GetAttr[name="w3"](%_13)
  %w1.27 : __torch__.torch.nn.modules.conv.___torch_mangle_54.Conv2d = prim::GetAttr[name="w1"](%_13)
  %967 : int = aten::size(%hidden_states.35, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %968 : int = aten::size(%hidden_states.35, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %969 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13
  %input.87 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.35, %969), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.201 : Tensor = prim::GetAttr[name="weight"](%w1.27)
  %972 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w1
  %973 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w1
  %974 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w1
  %975 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w1
  %input.89 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.87, %weight.201, %42, %972, %973, %974, %38, %975, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %977 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.89), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.203 : Tensor = prim::GetAttr[name="weight"](%w3.27)
  %979 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w3
  %980 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w3
  %981 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w3
  %982 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w3
  %983 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.87, %weight.203, %42, %979, %980, %981, %38, %982, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.91 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%977, %983), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.205 : Tensor = prim::GetAttr[name="weight"](%w2.27)
  %986 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w2
  %987 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w2
  %988 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w2
  %989 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w2
  %out.27 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.91, %weight.205, %42, %986, %987, %988, %38, %989, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13/__module.model.model.layers.0.block_sparse_moe.experts.13.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %991 : int[] = prim::ListConstruct(%967, %968), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13
  %992 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.27, %991), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.13 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %993 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %994 : Tensor?[] = prim::ListConstruct(%top_x.27, %idx.27), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %995 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%993, %994), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.27 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%992, %995), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %997 : int = aten::size(%final_hidden_states.27, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %998 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.27, %997), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.27 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%998, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %1000 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.27), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.27 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%1000, %current_hidden_states.27), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.29 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.27, %contributions.27, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %1003 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %21), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %1004 : Tensor[] = aten::where(%1003), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx.29 : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x.29 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%1004), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1007 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %1008 : Tensor?[] = prim::ListConstruct(%42, %top_x.29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1009 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%1007, %1008), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %1010 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states.37 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%1009, %1010), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2.29 : __torch__.torch.nn.modules.conv.___torch_mangle_59.Conv2d = prim::GetAttr[name="w2"](%_14)
  %w3.29 : __torch__.torch.nn.modules.conv.___torch_mangle_60.Conv2d = prim::GetAttr[name="w3"](%_14)
  %w1.29 : __torch__.torch.nn.modules.conv.___torch_mangle_58.Conv2d = prim::GetAttr[name="w1"](%_14)
  %1015 : int = aten::size(%hidden_states.37, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %1016 : int = aten::size(%hidden_states.37, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %1017 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14
  %input.93 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states.37, %1017), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.207 : Tensor = prim::GetAttr[name="weight"](%w1.29)
  %1020 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w1
  %1021 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w1
  %1022 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w1
  %1023 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w1
  %input.95 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.93, %weight.207, %42, %1020, %1021, %1022, %38, %1023, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %1025 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.95), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.209 : Tensor = prim::GetAttr[name="weight"](%w3.29)
  %1027 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w3
  %1028 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w3
  %1029 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w3
  %1030 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w3
  %1031 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.93, %weight.209, %42, %1027, %1028, %1029, %38, %1030, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input.97 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%1025, %1031), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight.211 : Tensor = prim::GetAttr[name="weight"](%w2.29)
  %1034 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w2
  %1035 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w2
  %1036 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w2
  %1037 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w2
  %out.29 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.97, %weight.211, %42, %1034, %1035, %1036, %38, %1037, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14/__module.model.model.layers.0.block_sparse_moe.experts.14.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %1039 : int[] = prim::ListConstruct(%1015, %1016), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14
  %1040 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out.29, %1039), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.14 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %1041 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %1042 : Tensor?[] = prim::ListConstruct(%top_x.29, %idx.29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1043 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%1041, %1042), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states.29 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%1040, %1043), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %1045 : int = aten::size(%final_hidden_states.29, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %1046 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x.29, %1045), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask.29 : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%1046, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %1048 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask.29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions.29 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%1048, %current_hidden_states.29), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states.31 : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.29, %contributions.29, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %1051 : Long(2, 64, strides=[16, 32], requires_grad=0, device=cpu) = aten::select(%expert_mask, %46, %22), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %1052 : Tensor[] = aten::where(%1051), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:630:0
  %idx : Long(0, strides=[1], requires_grad=0, device=cpu), %top_x : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::ListUnpack(%1052), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1055 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%hidden_states.7, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %1056 : Tensor?[] = prim::ListConstruct(%42, %top_x), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1057 : Half(1, 0, 4096, strides=[4096, 4096, 1], requires_grad=1, device=cpu) = aten::index(%1055, %1056), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %1058 : int[] = prim::ListConstruct(%29, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %hidden_states : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::reshape(%1057, %1058), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:651:0
  %w2 : __torch__.torch.nn.modules.conv.___torch_mangle_63.Conv2d = prim::GetAttr[name="w2"](%_15)
  %w3 : __torch__.torch.nn.modules.conv.___torch_mangle_64.Conv2d = prim::GetAttr[name="w3"](%_15)
  %w1 : __torch__.torch.nn.modules.conv.___torch_mangle_62.Conv2d = prim::GetAttr[name="w1"](%_15)
  %1063 : int = aten::size(%hidden_states, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %1064 : int = aten::size(%hidden_states, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:545:0
  %1065 : int[] = prim::ListConstruct(%29, %35, %43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15
  %input.99 : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=1, device=cpu) = aten::view(%hidden_states, %1065), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:547:0
  %weight.213 : Tensor = prim::GetAttr[name="weight"](%w1)
  %1068 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w1
  %1069 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w1
  %1070 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w1
  %1071 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w1
  %input.101 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.99, %weight.213, %42, %1068, %1069, %1070, %38, %1071, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w1 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %1073 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::silu(%input.101), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/functional.py:2380:0
  %weight.215 : Tensor = prim::GetAttr[name="weight"](%w3)
  %1075 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w3
  %1076 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w3
  %1077 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w3
  %1078 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w3
  %1079 : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input.99, %weight.215, %42, %1075, %1076, %1077, %38, %1078, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w3 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %input : Half(0, 6400, 1, 1, strides=[6400, 1, 1, 1], requires_grad=1, device=cpu) = aten::mul(%1073, %1079), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:549:0
  %weight : Tensor = prim::GetAttr[name="weight"](%w2)
  %1082 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w2
  %1083 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w2
  %1084 : int[] = prim::ListConstruct(%43, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w2
  %1085 : int[] = prim::ListConstruct(%46, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w2
  %out : Half(0, 4096, 1, 1, strides=[4096, 1, 1, 1], requires_grad=0, device=cpu) = aten::_convolution(%input, %weight, %42, %1082, %1083, %1084, %38, %1085, %43, %38, %38, %37, %37), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15/__module.model.model.layers.0.block_sparse_moe.experts.15.w2 # /Users/felixlin/workspace-apple-silicon/anemll-bench/env-anemll-bench/lib/python3.9/site-packages/torch/nn/modules/conv.py:549:0
  %1087 : int[] = prim::ListConstruct(%1063, %1064), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15
  %1088 : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::view(%out, %1087), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe/__module.model.model.layers.0.block_sparse_moe.experts.15 # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:551:0
  %1089 : Half(64, 2, 1, strides=[2, 1, 1], requires_grad=1, device=cpu) = aten::unsqueeze(%routing_weights, %34), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %1090 : Tensor?[] = prim::ListConstruct(%top_x, %idx), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1091 : Half(0, 1, strides=[1, 1], requires_grad=1, device=cpu) = aten::index(%1089, %1090), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %current_hidden_states : Half(0, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::mul(%1088, %1091), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:652:0
  %1093 : int = aten::size(%final_hidden_states.31, %46), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %1094 : Long(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::one_hot(%top_x, %1093), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %one_hot_mask : Half(0, 64, strides=[64, 1], requires_grad=0, device=cpu) = aten::to(%1094, %39, %38, %38, %42), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:663:0
  %1096 : Half(64, 0, strides=[1, 64], requires_grad=0, device=cpu) = aten::numpy_T(%one_hot_mask), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %contributions : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::matmul(%1096, %current_hidden_states), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:664:0
  %final_hidden_states : Half(64, 4096, strides=[4096, 1], requires_grad=1, device=cpu) = aten::add_(%final_hidden_states.31, %contributions, %43), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:665:0
  %1099 : int[] = prim::ListConstruct(%278, %280, %282), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe
  %1100 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::reshape(%final_hidden_states, %1099), scope: __module.model.model/__module.model.model.layers.0.block_sparse_moe # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:667:0
  %1101 : Half(1, 64, 4096, strides=[262144, 4096, 1], requires_grad=1, device=cpu) = aten::add(%input.5, %1100, %43), scope: __module.model.model # /Users/felixlin/workspace-apple-silicon/Anemll/anemll/models/phimoe_model.py:1303:0
  return (%1101)
